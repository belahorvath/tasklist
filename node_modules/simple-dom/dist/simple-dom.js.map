{"version":3,"file":"simple-dom.js","sources":["../src/simple-dom/document/node.ts","../src/simple-dom/document/element.ts","../src/simple-dom/document/document-fragment.ts","../src/simple-dom/document/comment.ts","../src/simple-dom/document/raw-html-section.ts","../src/simple-dom/document/text.ts","../src/simple-dom/document.ts","../src/simple-dom/html-parser.ts","../src/simple-dom/html-serializer.ts","../src/simple-dom/void-map.ts"],"sourcesContent":["export const enum NodeType {\n  RAW = -1,\n  ELEMENT_NODE = 1,\n  TEXT_NODE = 3,\n  COMMENT_NODE = 8,\n  DOCUMENT_NODE = 9,\n  DOCUMENT_FRAGMENT_NODE = 11,\n}\n\nexport interface NodeList {\n  item(index: number): Node;\n}\n\nexport default class Node {\n  public static ELEMENT_NODE: number = NodeType.ELEMENT_NODE;\n  public static TEXT_NODE: number = NodeType.TEXT_NODE;\n  public static COMMENT_NODE: number = NodeType.COMMENT_NODE;\n  public static DOCUMENT_NODE: number = NodeType.DOCUMENT_NODE;\n  public static DOCUMENT_FRAGMENT_NODE: number = NodeType.DOCUMENT_FRAGMENT_NODE;\n\n  public parentNode: Node | null = null;\n  public previousSibling: Node | null = null;\n  public nextSibling: Node | null = null;\n  public firstChild: Node | null = null;\n  public lastChild: Node | null = null;\n\n  private _childNodes: ChildNodes | undefined = undefined;\n\n  constructor(public readonly nodeType: number, public readonly nodeName: string, public nodeValue: string | null) {\n  }\n\n  public get childNodes() {\n    let children = this._childNodes;\n    if (children === undefined) {\n      children = this._childNodes = new ChildNodes(this);\n    }\n    return children as NodeList;\n  }\n\n  public cloneNode(deep?: boolean) {\n    const node = this._cloneNode();\n\n    if (deep === true) {\n      let child = this.firstChild;\n      let nextChild = child;\n\n      while (child !== null) {\n        nextChild = child.nextSibling;\n        node.appendChild(child.cloneNode(true));\n        child = nextChild;\n      }\n    }\n\n    return node;\n  }\n\n  public appendChild<T extends Node>(newChild: T): T {\n    if (newChild.nodeType === NodeType.DOCUMENT_FRAGMENT_NODE) {\n      insertFragment(newChild, this, this.lastChild, null);\n      return newChild;\n    }\n\n    if (newChild.parentNode) { newChild.parentNode.removeChild(newChild); }\n\n    newChild.parentNode = this;\n    const refNode = this.lastChild;\n    if (refNode === null) {\n      this.firstChild = newChild;\n      this.lastChild = newChild;\n    } else {\n      newChild.previousSibling = refNode;\n      refNode.nextSibling = newChild;\n      this.lastChild = newChild;\n    }\n\n    return newChild;\n  }\n\n  public insertBefore<T extends Node>(newChild: T, refChild: Node | null): T {\n    if (refChild == null) {\n      return this.appendChild(newChild);\n    }\n\n    if (newChild.nodeType === NodeType.DOCUMENT_FRAGMENT_NODE) {\n      insertFragment(newChild, this, refChild ? refChild.previousSibling : null, refChild);\n      return newChild;\n    }\n\n    if (newChild.parentNode) { newChild.parentNode.removeChild(newChild); }\n\n    newChild.parentNode = this;\n\n    const previousSibling = refChild.previousSibling;\n    if (previousSibling) {\n      previousSibling.nextSibling = newChild;\n      newChild.previousSibling = previousSibling;\n    } else {\n      newChild.previousSibling = null;\n    }\n\n    refChild.previousSibling = newChild;\n    newChild.nextSibling = refChild;\n\n    if (this.firstChild === refChild) {\n      this.firstChild = newChild;\n    }\n\n    return newChild;\n  }\n\n  public removeChild<T extends Node>(oldChild: T): T {\n    if (this.firstChild === oldChild) {\n      this.firstChild = oldChild.nextSibling;\n    }\n    if (this.lastChild === oldChild) {\n      this.lastChild = oldChild.previousSibling;\n    }\n    if (oldChild.previousSibling) {\n      oldChild.previousSibling.nextSibling = oldChild.nextSibling;\n    }\n    if (oldChild.nextSibling) {\n      oldChild.nextSibling.previousSibling = oldChild.previousSibling;\n    }\n    oldChild.parentNode = null;\n    oldChild.nextSibling = null;\n    oldChild.previousSibling = null;\n    return oldChild;\n  }\n\n  protected _cloneNode() {\n    return new Node(this.nodeType, this.nodeName, this.nodeValue);\n  }\n}\n\nfunction insertFragment(fragment: Node, newParent: Node, before: Node | null, after: Node | null) {\n  if (!fragment.firstChild) { return; }\n\n  const firstChild = fragment.firstChild;\n  let lastChild = firstChild;\n  let node: Node | null = firstChild;\n\n  firstChild.previousSibling = before;\n  if (before) {\n    before.nextSibling = firstChild;\n  } else {\n    newParent.firstChild = firstChild;\n  }\n\n  while (node) {\n    node.parentNode = newParent;\n    lastChild = node;\n    node = node.nextSibling;\n  }\n\n  lastChild.nextSibling = after;\n  if (after) {\n    after.previousSibling = lastChild;\n  } else {\n    newParent.lastChild = lastChild;\n  }\n}\n\nclass ChildNodes {\n  constructor(private node: Node) {\n  }\n\n  public item(index: number) {\n    let child = this.node.firstChild;\n\n    for (let i = 0; child && index !== i; i++) {\n      child = child.nextSibling;\n    }\n\n    return child;\n  }\n}\n","import Node, { NodeType } from './node';\n\nexport interface Attr {\n  readonly name: string;\n  readonly specified: boolean;\n  value: string;\n}\n\nexport default class Element extends Node {\n  public attributes: Attr[] = [];\n\n  constructor(tagName: string) {\n    super(NodeType.ELEMENT_NODE, tagName.toUpperCase(), null);\n  }\n\n  public get tagName(): string {\n    return this.nodeName;\n  }\n\n  public getAttribute(name: string): string | null {\n    const attributes = this.attributes;\n    const n = name.toLowerCase();\n    let attr;\n    for (let i = 0, l = attributes.length; i < l; i++) {\n      attr = attributes[i];\n      if (attr.name === n) {\n        return attr.value;\n      }\n    }\n    return null;\n  }\n\n  public setAttribute(name: string, value: string): void {\n    const attributes = this.attributes;\n    const n = name.toLowerCase();\n    let v: string;\n    if (typeof value === 'string') {\n      v = value;\n    } else {\n      v = '' + value;\n    }\n    let attr;\n    for (let i = 0, l = attributes.length; i < l; i++) {\n      attr = attributes[i];\n      if (attr.name === n) {\n        attr.value = v;\n        return;\n      }\n    }\n    attributes.push({\n      name: n,\n      specified: true, // serializer compat with old IE\n      value: v,\n    });\n  }\n\n  public removeAttribute(name: string): void {\n    const n = name.toLowerCase();\n    const attributes = this.attributes;\n    for (let i = 0, l = attributes.length; i < l; i++) {\n      const attr = attributes[i];\n      if (attr.name === n) {\n        attributes.splice(i, 1);\n        return;\n      }\n    }\n  }\n\n  protected _cloneNode() {\n    const node = new Element(this.tagName);\n\n    const attrs = node.attributes = [] as Attr[];\n\n    for (const attr of this.attributes) {\n      attrs.push({ name: attr.name, specified: attr.specified, value: attr.value });\n    }\n\n    return node;\n  }\n}\n","import Node, { NodeType } from './node';\n\nexport default class DocumentFragment extends Node {\n  constructor() {\n    super(NodeType.DOCUMENT_FRAGMENT_NODE, '#document-fragment', null);\n  }\n\n  protected _cloneNode() {\n    return new DocumentFragment();\n  }\n}\n","import Node, { NodeType } from './node';\n\nexport default class Comment extends Node {\n  constructor(text: string) {\n    super(NodeType.COMMENT_NODE, '#comment', text);\n  }\n\n  protected _cloneNode() {\n    return new Comment(this.nodeValue as string);\n  }\n}\n","import Node, { NodeType } from './node';\n\nexport default class RawHTMLSection extends Node {\n  constructor(text: string) {\n    super(NodeType.RAW, '#raw-html-section', text);\n  }\n}\n","import Node, { NodeType } from './node';\n\nexport default class Text extends Node {\n  constructor(text: string) {\n    super(NodeType.TEXT_NODE, '#text', text);\n  }\n\n  protected _cloneNode() {\n    return new Text(this.nodeValue as string);\n  }\n}\n","import Comment from './document/comment';\nimport DocumentFragment from './document/document-fragment';\nimport Element from './document/element';\nimport Node, { NodeType } from './document/node';\nimport RawHTMLSection from './document/raw-html-section';\nimport Text from './document/text';\n\nexport default class Document extends Node {\n  public documentElement: Element;\n  public head: Element;\n  public body: Element;\n\n  constructor() {\n    super(NodeType.DOCUMENT_NODE, '#document', null);\n    this.documentElement = new Element('html');\n    this.head = new Element('head');\n    this.body = new Element('body');\n    this.documentElement.appendChild(this.head);\n    this.documentElement.appendChild(this.body);\n    this.appendChild(this.documentElement);\n  }\n\n  public createElement(tagName: string) {\n    return new Element(tagName);\n  }\n\n  public createTextNode(text: string) {\n    return new Text(text);\n  }\n\n  public createComment(text: string) {\n    return new Comment(text);\n  }\n\n  public createRawHTMLSection(text: string) {\n    return new RawHTMLSection(text);\n  }\n\n  public createDocumentFragment() {\n    return new DocumentFragment();\n  }\n}\n","import Document from './document';\nimport DocumentFragment from './document/document-fragment';\nimport Element from './document/element';\nimport Node from './document/node';\n\nexport default class HTMLParser {\n  private parentStack: Node[];\n\n  constructor(private tokenize: Tokenizer, private document: Document, private voidMap: IVoidMap) {\n    this.tokenize = tokenize;\n    this.document = document;\n    this.voidMap = voidMap;\n    this.parentStack = [];\n  }\n\n  public isVoid(element: Element) {\n    return this.voidMap[element.nodeName] === true;\n  }\n\n  public pushElement(token: IStartTag) {\n    const el = this.document.createElement(token.tagName);\n\n    for (const attr of token.attributes) {\n      el.setAttribute(attr[0], attr[1]);\n    }\n\n    if (this.isVoid(el)) {\n      return this.appendChild(el);\n    }\n\n    this.parentStack.push(el);\n  }\n\n  public popElement(token: IEndTag) {\n    const el = this.parentStack.pop()!;\n\n    if (el.nodeName !== token.tagName.toUpperCase()) {\n      throw new Error('unbalanced tag');\n    }\n\n    this.appendChild(el);\n  }\n\n  public appendText(token: IChars) {\n    this.appendChild(this.document.createTextNode(token.chars));\n  }\n\n  public appendComment(token: IComment) {\n    this.appendChild(this.document.createComment(token.chars));\n  }\n\n  public appendChild(node: Node) {\n    const parentNode = this.parentStack[this.parentStack.length - 1];\n    parentNode.appendChild(node);\n  }\n\n  public parse(html: string) {\n    const fragment = this.document.createDocumentFragment();\n    this.parentStack.push(fragment);\n\n    const tokens = this.tokenize(html);\n    for (let i = 0, l = tokens.length; i < l; i++) {\n      const token = tokens[i];\n      switch (token.type) {\n        case 'StartTag':\n          this.pushElement(token);\n          break;\n        case 'EndTag':\n          this.popElement(token);\n          break;\n        case 'Chars':\n          this.appendText(token);\n          break;\n        case 'Comment':\n          this.appendComment(token);\n          break;\n      }\n    }\n\n    return this.parentStack.pop();\n  }\n}\n\nexport interface IVoidMap {\n  [tagName: string]: boolean | undefined;\n}\n\nexport type Tokenizer = (s: string) => Token[];\n\nexport type Token = IStartTag | IEndTag | IChars | IComment;\n\nexport type Attr = [string, string];\n\nexport interface IStartTag {\n  type: 'StartTag';\n  tagName: string;\n  attributes: Attr[];\n}\n\nexport interface IEndTag {\n  type: 'EndTag';\n  tagName: string;\n}\n\nexport interface IChars {\n  type: 'Chars';\n  chars: string;\n}\n\nexport interface IComment {\n  type: 'Comment';\n  chars: string;\n}\n","const ESC = {\n  '\"': '&quot;',\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n};\n\nfunction matcher(char: keyof typeof ESC) {\n  if (ESC[char] === undefined) {\n    return char;\n  }\n  return ESC[char];\n}\n\nexport default class HTMLSerializer {\n  constructor(private voidMap: {\n    [tagName: string]: boolean,\n  }) {\n  }\n\n  public openTag(element: Node) {\n    return '<' + element.nodeName.toLowerCase() + this.attributes(element.attributes) + '>';\n  }\n\n  public closeTag(element: Node) {\n    return '</' + element.nodeName.toLowerCase() + '>';\n  }\n\n  public isVoid(element: Node) {\n    return this.voidMap[element.nodeName] === true;\n  }\n\n  public attributes(namedNodeMap: NamedNodeMap) {\n    let buffer = '';\n    for (let i = 0, l = namedNodeMap.length; i < l; i++) {\n      buffer += this.attr(namedNodeMap[i]);\n    }\n    return buffer;\n  }\n\n  public escapeAttrValue(attrValue: string) {\n    if (attrValue.indexOf('&') > -1 || attrValue.indexOf('\"') > -1) {\n      return attrValue.replace(/[&\"]/g, matcher);\n    }\n\n    return attrValue;\n  }\n\n  public attr(attr: Attr) {\n    if (!attr.specified) {\n      return '';\n    }\n    if (attr.value) {\n      return ' ' + attr.name + '=\"' + this.escapeAttrValue(attr.value) + '\"';\n    }\n    return ' ' + attr.name;\n  }\n\n  public escapeText(textNodeValue: string) {\n    if (textNodeValue.indexOf('>') > -1 ||\n        textNodeValue.indexOf('<') > -1 ||\n        textNodeValue.indexOf('&') > -1\n    ) {\n      return textNodeValue.replace(/[&<>]/g, matcher);\n    }\n\n    return textNodeValue;\n  }\n\n  public text(text: Node) {\n    return this.escapeText(text.nodeValue!);\n  }\n\n  public rawHTMLSection(text: Node): string {\n    return text.nodeValue!;\n  }\n\n  public comment(comment: Node) {\n    return '<!--' + comment.nodeValue + '-->';\n  }\n\n  public serializeChildren(node: Node) {\n    let buffer = '';\n    let next = node.firstChild;\n    while (next !== null) {\n      buffer += this.serialize(next);\n      next = next.nextSibling;\n    }\n    return buffer;\n  }\n\n  public serialize(node: Node) {\n    let buffer = '';\n\n    // open\n    switch (node.nodeType) {\n      case 1:\n        buffer += this.openTag(node);\n        break;\n      case 3:\n        buffer += this.text(node);\n        break;\n      case -1:\n        buffer += this.rawHTMLSection(node);\n        break;\n      case 8:\n        buffer += this.comment(node);\n        break;\n      default:\n        break;\n    }\n\n    buffer += this.serializeChildren(node);\n\n    if (node.nodeType === 1 && !this.isVoid(node)) {\n      buffer += this.closeTag(node);\n    }\n\n    return buffer;\n  }\n}\n","export default {\n  AREA: true,\n  BASE: true,\n  BR: true,\n  COL: true,\n  COMMAND: true,\n  EMBED: true,\n  HR: true,\n  IMG: true,\n  INPUT: true,\n  KEYGEN: true,\n  LINK: true,\n  META: true,\n  PARAM: true,\n  SOURCE: true,\n  TRACK: true,\n  WBR: true,\n};\n"],"names":["const","let","super","this","attr","text","comment"],"mappings":"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"}